(()=>{"use strict";const t=(t,e)=>{const a=e||`Ship ${t}`,r=t,o=new Array(r).fill(!1);return{name:a,length:r,hit:t=>{if(t<0||t>r-1)throw new Error("Invalid Position Hit");o[t]=!0},hits:()=>[...o],isSunk:()=>o.every((t=>t))}},e=t=>JSON.parse(JSON.stringify(t)),a=()=>[{ship:t(5,"Carrier"),vertical:!1,location:null},{ship:t(4,"BattleShip"),vertical:!1,location:null},{ship:t(3,"Destroyer"),vertical:!1,location:null},{ship:t(3,"Submarine"),vertical:!1,location:null},{ship:t(2,"Patrol Boat"),vertical:!1,location:null}],r=t=>{const e=Object.prototype.hasOwnProperty;return!(!e.call(t,"vertical")||!e.call(t,"location")||!0!==t.vertical&&!1!==t.vertical||!(t=>{const e=Object.prototype.hasOwnProperty;if(!e.call(t,"x")||!e.call(t,"y"))return!1;const{x:a,y:r}=t;return"number"==typeof a&&"number"==typeof r&&!(a<0||a>9||r<0||r>9)})(t.location))},o=()=>({x:Math.floor(10*Math.random()),y:Math.floor(10*Math.random())}),n=t=>({name:t,attackBoard:(t,e)=>({location:t,result:e.recieveAttack(t)}),autoAttackBoard:t=>{let e,a=!1;do{e=o(),a=t.recieveAttack(e)}while(!a);return{location:e,result:a}}}),i=()=>{let a=e(new Array(10).fill(new Array(10).fill("")));const o=[],n=()=>e(a),i=t=>{const{vertical:e,ship:{length:a},location:r}=t,o=n();if(!r)return{newBoardState:o,newShipObjState:t};const{x:i,y:s}=r;for(let t=0;t<a;t++)e?o[i+t][s]="":o[i][s+t]="";return{newBoardState:o,newShipObjState:{...t,location:null}}};return{currBoardState:n,placeShipAt:(t,e)=>{if(!r(e))return!1;if(((t,e)=>{if(!r(e))return!1;const a=t.ship.length,{vertical:o,location:{x:n,y:s}}=e;if(o&&n+a>10||!o&&s+a>10)return!1;let{newBoardState:l}=i(t);for(let t=0;t<a;t++){if(o&&l[n+t][s])return!1;if(l[n][s+t])return!1}return!0})(t,e)){const r=t.ship.length,{vertical:o,location:{x:n,y:s}}=e;let{newBoardState:l}=i(t);a=l;for(let t=0;t<r;t++)o?a[n+t][s]="O":a[n][s+t]="O";return t.vertical=e.vertical,t.location=e.location,!0}return!1},recieveAttack:t=>{const{x:e,y:r}=t;if("*"===a[e][r]||"X"===a[e][r])return!1;if(""===a[e][r])return a[e][r]="*","Miss";a[e][r]="X";const n=o.find((t=>{const{ship:{length:a},vertical:o,location:{x:n,y:i}}=t;return o?n<=e&&e<n+a&&i===r:n===e&&i<=r&&r<i+a}));return n.vertical?n.ship.hit(e-n.location.x):n.ship.hit(r-n.location.y),"Hit"},gameOver:()=>o.every((t=>t.ship.isSunk())),addShipInfo:e=>!(!e.ship instanceof t||!0!==e.vertical&&!1!==e.vertical||(e.location=null,o.push(e),0))}},s=document.getElementById("player-board-div"),l=document.getElementById("computer-board-div"),c=document.getElementById("instructions"),d=document.getElementById("rotate"),u=document.getElementById("winner"),p=document.getElementById("reset-modal"),h=()=>{L(),s.textContent="",s.classList.remove("lock-board"),l.textContent="";const t=n("Computer"),e=y(),a=v(e.currBoardState());a.classList.add("computer"),a.classList.add("hidden"),l.appendChild(a);const r=n("Player"),o=i(),c=v(o.currBoardState());s.appendChild(c),m({player:r,playerBoard:o,playerDOMBoard:c,computer:t,computerBoard:e,ComputerDOMBoard:a})},m=t=>{const{playerBoard:e,playerDOMBoard:r,ComputerDOMBoard:o}=t,n=r.querySelectorAll(".square"),i=a();let l=!1;const u=()=>{l=!l,d.textContent=l?"Rotate X":"Rotate Y"};i.forEach((t=>e.addShipInfo(t))),d.addEventListener("click",u),d.classList.remove("hidden");const p=()=>{if(0===i.length)return c.textContent="",s.classList.add("lock-board"),o.classList.remove("hidden"),d.classList.add("hidden"),d.removeEventListener("click",u),console.log("finished adding ships"),void f(t);{const t=i[0],a=t.ship.name,r=t.ship.length;c.textContent=`Place your ${a}`;const o=a=>{let{classList:n,dataset:{x:c,y:u}}=a.target;if(n.contains("square")){c=parseInt(c),u=parseInt(u);const a={location:{x:c,y:u},vertical:l};if(e.placeShipAt(t,a)){for(let t=0;t<r;t++)s.querySelector(`.square[data-x="${l?c+t:c}"][data-y="${l?u:u+t}"]`).classList.add("ship");i.shift()}}s.removeEventListener("mouseover",d),s.removeEventListener("click",o),p()},d=t=>{const e=parseInt(t.target.dataset.x),a=parseInt(t.target.dataset.y);n.forEach((t=>t.classList.remove("spot")));for(let t=0;t<r;t++)!e&&0!==e||e+t>9&&l||a+t>9&&!l||s.querySelector(`.square[data-x="${l?e+t:e}"][data-y="${l?a:a+t}"]`).classList.add("spot")};s.addEventListener("click",o),s.addEventListener("mouseover",d)}};p()},y=()=>{const t=i();return a().forEach((e=>{let a=!1;t.addShipInfo(e);do{a=t.placeShipAt(e,{vertical:Math.floor(100*Math.random())<50,location:o()})}while(!a)})),t},v=t=>{const e=document.createElement("div");return e.classList.add("gameboard-container"),t.forEach(((t,a)=>{t.forEach(((t,r)=>{const o=document.createElement("div");o.setAttribute("data-x",a),o.setAttribute("data-y",r),o.classList="square "+("O"===t?"ship":"water"),e.appendChild(o)}))})),e},f=t=>{L();const{player:e,playerBoard:a,playerDOMBoard:r,computer:o,computerBoard:n,ComputerDOMBoard:i}=t;let c=!0;s.classList.add("lock-board");const d=(t,e)=>!("Hit"!==t||!e.gameOver()||(i.removeEventListener("click",u),L(c),0)),u=t=>{const{classList:s,dataset:{x:l,y:u}}=t.target;if(!s.contains("hit")&&s.contains("square")&&c){const t={x:parseInt(l),y:parseInt(u)};let{result:s}=e.attackBoard(t,n);if(B(i,t),d(s,n))return;c=!c,(()=>{const{result:t,location:e}=o.autoAttackBoard(a);B(r,e),d(t,a)||(c=!c)})()}};l.addEventListener("click",u)},B=(t,e)=>{const{x:a,y:r}=e;t.querySelector(`.square[data-x="${a}"][data-y="${r}"]`).classList.add("hit")},L=(t=null)=>{if(console.log("resetting game"),!0===t||!1===t){u.textContent=!1===t?"Computer Wins":!0===t?"Player Wins":"";const e=document.getElementById("new-game");l.classList.add("lock-board"),g("on"),e.addEventListener("click",h)}else l.classList.remove("lock-board"),g("off")},g=t=>{"on"===t?p.classList.add("show"):"off"===t&&p.classList.remove("show")};h()})();
//# sourceMappingURL=app.07de05d54f24dc442b2a.js.map